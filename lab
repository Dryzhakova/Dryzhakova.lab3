
import pandas as pd
import numpy as np

def connect_data():
    data_frame = pd.read_csv('titanic.csv', sep=';')
    return data_frame
# Перевірити наявність пустих значень в спостереженнях (NaN заначення в строках). 
def empty_values(data_frame):
    empty_value = data_frame
    empty_value = pd.DataFrame(empty_value.isnull().sum(axis=1), columns=['NaN'])
    return empty_value
#Видалити атрибут, якій містить максимальну кількість відсутніх значень
def delete_of_max_empty_values(data_frame, empty_value):
    delete_value = data_frame
    max_value = empty_value['empty_value'].max()
    delete_value = delete.drop(np.where(empty_value['empty_value'] == max_value)[0])#Удалить строки и столбцы
    return delete_value
#Видалити спостереження, які містять хоча б одне значення NaN
def delete_of_nan(data_frame):
    delete_value = data_frame
    delete_value = delete_value.dropna()#удаления строк и столбцов с значениями NULL/NAN.
    return delete_value
# У окрему структуру даних data frame згрупувати дані спостережнь для жінок, чоловіків та дітей.
def data_frame_group(data_frame):
    children = data_frame.loc[data_frame['Age'] < 18]
    print("\nChildren:\n", children)
    children_group = children.groupby(children['Sex'])
    for value in children_group.groups.keys():
        edult_group = pd.DataFrame(children_group.get_group(value))
        print("\n Men and Women groups:\n", edult_group)

data_frame = connect_data()
print("Data Frame:\n", data_frame)
print("\nWith NaN:\n", empty_values(data_frame))
#Видалення атрибута, якій містить максимальну кількість відсутніх значень
print("\nDelete attribute of max empty value :\n", delete_of_max_empty_values(data_frame, empty_value))
#Видалити спостереження, які містять хоча б одне значення NaN
data_frame = delete_of_nan(data_frame)
print("\nRemove at least one occurrence of NaN:\n", data_frame)
#згровані дані спостережнь для жінок, чоловіків та дітей.
print(data_frame_group(data_frame))


